let STATUS_FLOW=["Read it","Not read","Just reading"],STORAGE_KEY="bookshelf:data:v1",selectors={addBookButton:document.getElementById("addBookBtn"),modal:document.getElementById("BookModal"),overlay:document.getElementById("overlay"),closeModalButton:document.getElementById("closeModalButton"),library:document.getElementById("library"),form:document.getElementById("addBookForm"),statusDefault:document.getElementById("reading")};function createId(){return window.crypto?.randomUUID?window.crypto.randomUUID():`book-${Date.now()}-${Math.random().toString(16).slice(2)}`}function sanitizeText(e){return e.trim()}function normalizePages(e){let t=Number(e);return Number.isFinite(t)&&t>0?t:0}function getNextStatus(e){let t=STATUS_FLOW.indexOf(e);return -1===t?STATUS_FLOW[0]:STATUS_FLOW[(t+1)%STATUS_FLOW.length]}class Book{constructor({id:e=createId(),title:t,author:a,pages:s,status:r}){this.id=e,this.title=sanitizeText(t),this.author=sanitizeText(a),this.pages=normalizePages(s),this.status=STATUS_FLOW.includes(r)?r:STATUS_FLOW[0]}toggleStatus(){this.status=getNextStatus(this.status)}toJSON(){return{id:this.id,title:this.title,author:this.author,pages:this.pages,status:this.status}}}class Library{constructor(e="bookshelf:data:v1"){this.storageKey=e,this.shelf=[]}load(e=[]){let t=localStorage.getItem(this.storageKey);if(!t){this.shelf=e.map(e=>new Book(e)),this.persist();return}try{let e=JSON.parse(t);this.shelf=Array.isArray(e)?e.map(e=>new Book(e)):[]}catch(e){console.error("Failed to parse saved library data:",e),this.shelf=[]}}persist(){localStorage.setItem(this.storageKey,JSON.stringify(this.shelf))}add(e){let t=e instanceof Book?e:new Book(e);return this.shelf.push(t),this.persist(),t}remove(e){let t=this.shelf.length;return this.shelf=this.shelf.filter(t=>t.id!==e),this.shelf.length!==t&&(this.persist(),!0)}updateStatus(e){let t=this.find(e);return t?(t.toggleStatus(),this.persist(),t):null}find(e){return this.shelf.find(t=>t.id===e)??null}isEmpty(){return 0===this.shelf.length}}let library=new Library,DEFAULT_BOOKS=[{title:"Beksinski Fotografia",author:"Wieslaw Banach",pages:64,status:"Read it"},{title:"Alexander Lowen",author:"Radość",pages:327,status:"Just reading"},{title:"Iron John",author:"Robert Bly",pages:264,status:"Not read"}];function openModal(){selectors.form.reset(),selectors.statusDefault.checked=!0,selectors.modal.classList.add("active"),selectors.overlay.classList.add("active")}function closeModal(){selectors.modal.classList.remove("active"),selectors.overlay.classList.remove("active")}function handleOverlayClick(){closeModal()}function handleEscapeKey(e){"Escape"===e.key&&selectors.modal.classList.contains("active")&&closeModal()}function createEmptyState(){let e=document.createElement("div");return e.className="card empty-state",e.innerHTML="<p>No books on the shelf yet.</p><p>Add your first book to get started!</p>",e}function createBookCard(e){let t=document.createElement("div");t.className="card",t.dataset.bookId=e.id;let a=document.createElement("p");a.className="card-title",a.textContent=`"${e.title}"`;let s=document.createElement("p");s.className="card-author",s.textContent=`by ${e.author}`;let r=document.createElement("p");r.className="card-pages",r.textContent=`${e.pages} ${1===e.pages?"page":"pages"}`;let o=document.createElement("div");o.className="status-container";let l=document.createElement("p");l.className="card-status",l.textContent=e.status;let n=document.createElement("button");n.className="change-status-button",n.textContent="Change status",n.dataset.action="toggle-status",o.append(l,n);let i=document.createElement("button");return i.className="remove-button",i.textContent="Remove book",i.dataset.action="remove",t.append(a,s,r,o,i),t}function renderLibrary(){if(selectors.library.innerHTML="",library.isEmpty())return void selectors.library.appendChild(createEmptyState());let e=document.createDocumentFragment();library.shelf.forEach(t=>{e.appendChild(createBookCard(t))}),selectors.library.appendChild(e)}function handleLibraryClick(e){let t=e.target.closest("button");if(!t)return;let a=t.closest(".card");if(!a)return;let{bookId:s}=a.dataset,{action:r}=t.dataset;if(s&&r){if("toggle-status"===r){library.updateStatus(s),renderLibrary();return}"remove"===r&&(library.remove(s),renderLibrary())}}function handleFormSubmit(e){if(e.preventDefault(),!selectors.form.reportValidity())return;let t=new FormData(selectors.form),a=t.get("title"),s=t.get("author"),r=t.get("pages"),o=t.get("status");library.add({title:a,author:s,pages:r,status:o}),renderLibrary(),closeModal()}library.load(DEFAULT_BOOKS),selectors.addBookButton.addEventListener("click",openModal),selectors.overlay.addEventListener("click",handleOverlayClick),selectors.closeModalButton.addEventListener("click",e=>{e.preventDefault(),closeModal()}),selectors.library.addEventListener("click",handleLibraryClick),selectors.form.addEventListener("submit",handleFormSubmit),document.addEventListener("keydown",handleEscapeKey),renderLibrary();
//# sourceMappingURL=library-project.8a8967f4.js.map
